print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active))
scatter_with_LOBF <- function(data_x, data_y) {
data <- tibble(
x = data_x,
y = data_y
)
p <- ggplot(data,
aes(x = data$x, y = data$y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = 0.1,
vjust = 1.1)
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active))
scatter_with_LOBF <- function(data_x, data_y) {
data <- tibble(
x = data_x,
y = data_y
)
p <- ggplot(data,
aes(x = data$x, y = data$y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1)
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
p <- ggplot(data,
aes(x = data$x, y = data$y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active))
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2])
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
?caption
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = cor(data_x, data_y)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = round(cor(data_x, data_y), digits = 2)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = round(cor(data$x, data$y), digits = 2)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = round(cor(data$x, data$y), digits = 2)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
method="pearson",
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = round(cor(data$x, data$y, method="pearson"), digits = 2)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
method="pearson",
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
correlation = round(cor(data$x, data$y, method="pearson"), digits = 2) + 1
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
method="pearson",
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2],
caption = paste("R^2 =", correlation))
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
scatter_with_LOBF <- function(data_x, data_y, labels) {
data <- tibble(
x = data_x,
y = data_y
)
p <- ggplot(data,
aes(x = x, y = y)) +
geom_point() +
geom_smooth(method = "lm",
se = FALSE,
color = "blue") +
stat_cor(mapping=aes(label=..rr.label..),
method="pearson",
label.x=-Inf,
label.y=Inf,
hjust = -0.1,
vjust = 1.1) +
labs(title = paste(labels[1], "vs.", labels[2]),
x = labels[1],
y = labels[2])
return(p)
}
print(scatter_with_LOBF(distance_vs_very_active$mean_minutes_very_active,
distance_vs_very_active$mean_distance_very_active,
c("Minutes", "Distance")))
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
distance_vs_active <- activity_sum_days_wide %>%
select(id, activity_day,
distance_moderately_active,
distance_very_active,
minutes_moderately_active,
minutes_very_active) %>%
mutate(distance_active = distance_moderately_active + distance_very_active,
minutes_active = minutes_moderately_active + minutes_very_active) %>%
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
distance_vs_active <- activity_sum_days_wide %>%
select(id, activity_day,
distance_moderately_active,
distance_very_active,
minutes_moderately_active,
minutes_very_active) %>%
mutate(distance_active = distance_moderately_active + distance_very_active,
minutes_active = minutes_fairly_active + minutes_very_active) %>%
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
distance_vs_active <- activity_sum_days_wide %>%
select(id, activity_day,
distance_moderately_active,
distance_very_active,
minutes_fairly_active,
minutes_very_active) %>%
mutate(distance_active = distance_moderately_active + distance_very_active,
minutes_active = minutes_fairly_active + minutes_very_active) %>%
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
View(distance_vs_active)
p <- scatter_with_LOBF(distance_vs_active$mean_minutes_active,
distance_vs_active$mean_distance_active,
c("Minutes", "Distance"))
print(p)
p <- scatter_with_LOBF(distance_vs_active$mean_minutes_active,
distance_vs_active$mean_distance_active,
c("Active Minutes", "Active Distance")) +
labs(caption = "\"Active\" refers to time spent either Fairly or Very Active")
print(p)
p <- wide_to_stacked_bar_plot(distance_vs_intensity_pct, "intensity", "distance", stack_order) +
labs(title = "Intensity Levels as Percentage of Distance Covered")
print(p)
distance_vs_active <- activity_sum_days_wide %>%
select(id, activity_day,
distance_moderately_active,
distance_very_active,
minutes_fairly_active,
minutes_very_active) %>%
mutate(distance_active = distance_moderately_active + distance_very_active,
minutes_active = minutes_fairly_active + minutes_very_active) %>%
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
p <- scatter_with_LOBF(distance_vs_active$mean_minutes_active,
distance_vs_active$mean_distance_active,
c("Active Minutes", "Active Distance")) +
labs(caption = "\"Active\" refers to time spent either Fairly or Very Active")
print(p)
# I'm not sure if this needs to be in the final analysis, just that it was used as the testbed for the useful wide_to_stacked_bar_plot() function, so I'm keeping it here for reference when I integrate that function into the rest of the analysis
average_distances <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance = mean(distance_total))
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
ggplot(distance_vs_intensity, aes(x = mean_distance_total, y = pct_distance_very_active)) +
geom_point()
distance_vs_intensity_pct <- distance_vs_intensity %>%
select(id,
pct_distance_very_active,
pct_distance_moderately_active,
pct_distance_lightly_active,
pct_distance_sedentary)
# I'm not sure if this needs to be in the final analysis, just that it was used as the testbed for the useful wide_to_stacked_bar_plot() function, so I'm keeping it here for reference when I integrate that function into the rest of the analysis
average_distances <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance = mean(distance_total))
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
ggplot(distance_vs_intensity, aes(x = mean_distance_total, y = pct_distance_very_active)) +
geom_point()
distance_vs_intensity_pct <- distance_vs_intensity %>%
select(id,
pct_distance_very_active,
pct_distance_moderately_active,
pct_distance_lightly_active,
pct_distance_sedentary)
# I'm not sure if this needs to be in the final analysis, just that it was used as the testbed for the useful wide_to_stacked_bar_plot() function, so I'm keeping it here for reference when I integrate that function into the rest of the analysis
average_distances <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance = mean(distance_total))
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
ggplot(distance_vs_intensity, aes(x = mean_distance_total, y = pct_distance_very_active)) +
geom_point()
distance_vs_intensity_pct <- distance_vs_intensity %>%
select(id,
pct_distance_very_active,
pct_distance_moderately_active,
pct_distance_lightly_active,
pct_distance_sedentary)
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
View(distance_vs_intensity)
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_lightly_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
# I'm not sure if this needs to be in the final analysis, just that it was used as the testbed for the useful wide_to_stacked_bar_plot() function, so I'm keeping it here for reference when I integrate that function into the rest of the analysis
average_distances <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance = mean(distance_total))
distance_vs_intensity <- activity_sum_days_wide %>%
group_by(id) %>%
summarize(mean_distance_very_active = mean(distance_very_active),
mean_distance_moderately_active = mean(distance_moderately_active),
mean_distance_lightly_active = mean(distance_lightly_active),
mean_distance_sedentary = mean(distance_sedentary)) %>%
mutate(mean_distance_total = mean_distance_very_active +
mean_distance_moderately_active +
mean_distance_lightly_active +
mean_distance_sedentary) %>%
mutate(pct_distance_very_active = mean_distance_very_active / mean_distance_total,
pct_distance_moderately_active = mean_distance_moderately_active / mean_distance_total,
pct_distance_lightly_active = mean_distance_lightly_active / mean_distance_total,
pct_distance_sedentary = mean_distance_sedentary / mean_distance_total)
ggplot(distance_vs_intensity, aes(x = mean_distance_total, y = pct_distance_very_active)) +
geom_point()
distance_vs_intensity_pct <- distance_vs_intensity %>%
select(id,
pct_distance_very_active,
pct_distance_moderately_active,
pct_distance_lightly_active,
pct_distance_sedentary)
stack_order <- c("pct_distance_very_active",
"pct_distance_moderately_active",
"pct_distance_lightly_active",
"pct_distance_sedentary")
p <- wide_to_stacked_bar_plot(distance_vs_intensity_pct, "intensity", "distance", stack_order) +
labs(title = "Intensity Levels as Percentage of Distance Covered")
print(p)
View(distance_vs_intensity_pct)
histo_data <- distance_vs_intensity_pct %>%
select(id,
pct_distance_very_active,
pct_distance_moderately_active) %>%
mutate(pct_distance_active = pct_distance_very_active + pct_distance_moderately_active)
View(histo_data)
p <- plot_histo_pareto(histo_data$pct_distance_active,
bin_width = 0.1)
print(p)
(33-19)/33
8/33
p <- plot_histo_pareto(histo_data$pct_distance_active,
bin_width = 0.1) +
labs(title = "Active Distance as Percentage of Total Distance")
print(p)
distance_vs_active <- activity_sum_days_wide %>%
select(id, activity_day,
distance_moderately_active,
distance_very_active,
minutes_fairly_active,
minutes_very_active) %>%
mutate(distance_active = distance_moderately_active + distance_very_active,
minutes_active = minutes_fairly_active + minutes_very_active) %>%
group_by(id) %>%
summarize(mean_distance_active = mean(distance_active),
mean_minutes_active = mean(minutes_active))
p <- scatter_with_LOBF(distance_vs_active$mean_minutes_active,
distance_vs_active$mean_distance_active,
c("Active Minutes", "Active Distance")) +
labs(caption = "\"Active\" refers to time spent either Fairly or Very Active")
print(p)
