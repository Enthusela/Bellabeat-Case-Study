# Chunk 68: share_viz_very_active_vs_total_active
print(viz_very_active_vs_total_active)
# Chunk 69: share_viz_mean_daily_steps
print(viz_mean_daily_steps)
# Chunk 70: share_viz_walking
print(viz_walking_speed_frequency)
# Chunk 71: share_viz_all_intensity_over_time
print(viz_all_intensity_over_time)
# Chunk 72: share_viz_mean_daily_steps_vs_time
print(viz_mean_daily_steps_vs_time)
# Chunk 73: share_viz_all_walking_over_time
print(viz_all_walking_over_time)
# Chunk 74: share_viz_distance_vs_activity
print(viz_distance_vs_activity)
# Chunk 75: share_viz_night_usage_sleep_logs
print(viz_night_usage_sleep_logs)
# Chunk 76: share_viz_night_usage_heartrate
print(viz_night_usage_heartrate)
# Chunk 77: share_viz_sleep_logs_vs_hr_logs
print(viz_sleep_logs_vs_hr_logs)
apdx_A_labels <- knitr::all_labels()
print(apdx_A_labels)
?knitr::all_labels
?filter
?grep
apdx_A_labels <- c("asdf", "prep-asdf", "prep-asdf2", "asdf2")
print(apdx_A_labels)
apdx_A_labels <- apdx_A_labels[grep("^prep-", apdx_A_labels)]
print(apdx_A_labels)
?grepl
# Chunk 1: setup
# Set up knitting options with the knitr package
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
# Load all required packages
print("Loading packages...")
rqd_pkgs <- c(
"dplyr",
"anytime",
"tidyverse",
"janitor",
"readr",
"skimr",
"tibble",
"ggplot2",
"gridExtra",
"ggpubr",
"kableExtra",
"purrr"
)
lapply(rqd_pkgs, function(pkg) {
if(!requireNamespace(pkg, quietly = FALSE)) {
cran_mirror <- "https://cran.r-project.org"
install.packages(as.character(pkg), repos = cran_mirror)
}
library(pkg, character.only = TRUE)
})
rm(rqd_pkgs)
print("Loading packages complete.")
# Chunk 2: prep-set-dir
# Set the working directory of the R markdown environment to match that of the console
dir <- "/Users/nathanweaver/Documents/GitHub/Bellabeat Case Study"
setwd(dir)
cat("Set working directory to:", dir, "\n")
# Chunk 3: prep-load-data-cleaned
# Load all CSVs in the source directory into the environment
csv_dir <- "Fitabase_Data_Cleaned"
paths_dfs <- list.files(csv_dir, pattern = "*.csv", full.names = TRUE)
df_names <- paths_dfs %>%
basename() %>%
tools::file_path_sans_ext()
for (i in 1:length(df_names)) {
assign(df_names[i], read_csv(paths_dfs[i]))
}
rm(i, paths_dfs)
# Chunk 4: prep-get-intensity-range
# Display all unique Exercise Intensity values
print(unique(intensity_src_mins_tall$Intensity))
# Chunk 5: prep-compare-intensity-data
# Generate my version of sleepDay_merged for comparison with the original
intensity_daily_sum_wide <- intensity_src_mins_tall %>%
mutate(activity_date_floored = floor_date(mdy_hms(ActivityMinute), unit = "days")) %>%
group_by(Id, activity_date_floored) %>%
summarize(
minutes_sedentary      = sum(case_when(Intensity == 0 ~ 1, TRUE ~ 0)),
minutes_lightly_active = sum(case_when(Intensity == 1 ~ 1, TRUE ~ 0)),
minutes_fairly_active  = sum(case_when(Intensity == 2 ~ 1, TRUE ~ 0)),
minutes_very_active    = sum(case_when(Intensity == 3 ~ 1, TRUE ~ 0))
) %>%
mutate(Id_ActivityDate_UID = paste(Id, activity_date_floored, sep = "_")) %>%
arrange(Id, activity_date_floored, Id_ActivityDate_UID)
# Compare both versions of the data and return any dates with different values
intensity_daily_comp <- activity_sum_days_wide %>%
mutate(ActivityDate_floored = floor_date(mdy(ActivityDate), unit = "days")) %>%
mutate(Id_ActivityDate_UID = paste(Id, ActivityDate_floored, sep = "_")) %>%
with(merge(
.,
intensity_daily_sum_wide,
by = c("Id_ActivityDate_UID"),
all = TRUE
)
) %>%
mutate(diff_minutes_sedentary      = minutes_sedentary      - SedentaryMinutes     ) %>%
mutate(diff_minutes_lightly_active = minutes_lightly_active - LightlyActiveMinutes ) %>%
mutate(diff_minutes_fairly_active  = minutes_fairly_active  - FairlyActiveMinutes  ) %>%
mutate(diff_minutes_very_active    = minutes_very_active    - VeryActiveMinutes    ) %>%
select(
Id_ActivityDate_UID,
diff_minutes_sedentary,
diff_minutes_lightly_active,
diff_minutes_fairly_active,
diff_minutes_very_active
) %>%
filter(!(diff_minutes_sedentary == 0 &
diff_minutes_lightly_active == 0 &
diff_minutes_fairly_active == 0 &
diff_minutes_very_active == 0)
) %>%
arrange(Id_ActivityDate_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
cat("Table below shows differences between original and reconstructed summary data:\n")
glimpse(intensity_daily_comp)
rm(intensity_daily_sum_wide, intensity_daily_comp)
# Chunk 6: prep-get-sleep-value-range
# Display all unique Sleep Value values
print(unique(sleep_src_mins_tall$value))
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(case_when(value == 3 ~ 1, TRUE ~ 0)),
"minutes_restless" = sum(case_when(value == 2 ~ 1, TRUE ~ 0)),
"minutes_asleep"   = sum(case_when(value == 1 ~ 1, TRUE ~ 0))
) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
rm(sleep_src_mins_tall_NW, sleepDay_comp)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(case_when(value == 3 ~ 1, TRUE ~ 0)),
"minutes_restless" = sum(case_when(value == 2 ~ 1, TRUE ~ 0)),
"minutes_asleep"   = sum(case_when(value == 1 ~ 1, TRUE ~ 0))
) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
# rm(sleep_src_mins_tall_NW, sleepDay_comp)
?case_when
glimpse(sleep_src_mins_tall_NW)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(value == 3),
"minutes_restless" = sum(value == 2),
"minutes_asleep"   = sum(value == 1))
) %>%
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(value == 3),
"minutes_restless" = sum(value == 2),
"minutes_asleep"   = sum(value == 1)) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
# rm(sleep_src_mins_tall_NW, sleepDay_comp)
glimpse(sleep_src_mins_tall_NW)
View(sleep_src_mins_tall)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored)) %>%
# Sum time asleep for each date based on SleepDay
group_by(id, SleepDay) %>%
summarize("TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless)) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(value == 3),
"minutes_restless" = sum(value == 2),
"minutes_asleep"   = sum(value == 1)) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
# rm(sleep_src_mins_tall_NW, sleepDay_comp)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = min(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(value == 3),
"minutes_restless" = sum(value == 2),
"minutes_asleep"   = sum(value == 1)) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
# rm(sleep_src_mins_tall_NW, sleepDay_comp)
# Generate my version of sleepDay_merged for comparison with the original
sleep_src_mins_tall_NW <- sleep_src_mins_tall %>%
# mutate(date_typed = mdy_hms(date)) %>%
mutate(date_floored = floor_date(mdy_hms(date), unit = "days")) %>%
# Sum time asleep for each Log ID
group_by(logId) %>%
summarize(
"Id" = min(Id),
# Associate each Log ID with the latest date recorded under it
"SleepDay" = max(date_floored),
"minutes_in_bed"   = n(),
"minutes_awake"    = sum(value == 3),
"minutes_restless" = sum(value == 2),
"minutes_asleep"   = sum(value == 1)) %>%
# Sum time asleep for each date based on SleepDay
group_by(Id, SleepDay) %>%
summarize(
"TotalSleepRecords_2" = n(),
"TotalMinutesAsleep_2" = sum(minutes_asleep),
"TotalTimeInBed_2" = sum(minutes_in_bed),
"TotalMinutesAwake" = sum(minutes_awake),
"TotalMinutesRestless" = sum(minutes_restless),
) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay, sep = "_")) %>%
arrange(Id_SleepDay_UID)
# Compare both versions of the data and return any dates with different values
sleepDay_comp <- sleep_sum_days_wide %>%
# mutate("SleepDay_typed" = mdy_hms(SleepDay)) %>%
mutate("SleepDay_floored" = floor_date(mdy_hms(SleepDay), unit = "days")) %>%
mutate("Id_SleepDay_UID" = paste(Id, SleepDay_floored, sep = "_")) %>%
arrange(Id_SleepDay_UID) %>%
with(merge(
.,
sleep_src_mins_tall_NW,
by = c("Id_SleepDay_UID"),
all = TRUE
)
) %>%
mutate(recordDiff = TotalSleepRecords_2 - TotalSleepRecords) %>%
mutate(sleepDiff = TotalMinutesAsleep_2 - TotalMinutesAsleep) %>%
mutate(bedDiff = TotalTimeInBed_2 - TotalTimeInBed) %>%
select(
Id_SleepDay_UID,
recordDiff,
sleepDiff,
bedDiff
) %>%
filter(!(recordDiff == 0 & sleepDiff == 0 & bedDiff == 0)) %>%
arrange(Id_SleepDay_UID)
# For this table, glimpse() shows enough to demonstrate the validity of the method
glimpse(sleepDay_comp)
# rm(sleep_src_mins_tall_NW, sleepDay_comp)
View(sleep_src_mins_tall_NW)
View(sleep_sum_days_wide)
View(sleep_sum_days_wide)
View(sleepDay_comp %>% filter(sleepDiff >= 500))
View(sleepDay_comp %>% filter(sleepDiff >= 100))
View(sleepDay_comp %>% filter(sleepDiff >= 20))
View(sleep_sum_days_wide %>% filter(id == "4388161847"))
View(sleep_sum_days_wide %>% filter(Id == "4388161847"))
View(sleep_sum_days_wide %>% filter(id == "4702921684"))
View(sleep_sum_days_wide %>% filter(Id == "4702921684"))
View(sleepDay_comp %>% filter(Id == "4702921684"))
View(sleepDay_comp %>% filter(id == "4702921684"))
View(sleepDay_comp %>% filter(sleepDiff >= 20))
View(sleep_src_mins_tall %>% filter(Id == "4702921684"))
data_filtered <- sleep_src_mins_tall %>%
filter(Id == "4702921684",
date > "2016-05-07",
date > "2016-05-08")
View(data_filtered)
data_filtered <- sleep_src_mins_tall %>%
filter(Id == "4702921684",
yday(date) > yday("2016-05-07"))
View(data_filtered)
data_filtered <- sleep_src_mins_tall %>%
filter(Id == "4702921684",
date > as.POSIXct("2016-05-07", tz = "UTC"))
?as.POSIXct
start_date<-as.POSIXct("2016-05-07", tz = "UTC")
data_filtered <- sleep_src_mins_tall %>%
filter(Id == "4702921684",
date > start_date)
