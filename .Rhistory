arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_histo_pareto <- function (data, bin_width) {
# Cumulative data uses same bins as histogram
data <- sort(data)
rounding_factor <- 1 / bin_width
data_rounded <- round(data * rounding_factor) / rounding_factor
# Calculate highest count so axes can be adjusted
highest_count <- max(table(data_rounded))
data_pareto <- seq(1, length(data), by = 1) / length(data) * highest_count
# Calculate stats for overlay on histogram
data_max <- max(data)
data_mean <- round(mean(data), digits = 2)
data_median <- round(median(data), digits = 2)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(data_mean, data_median))
label_text <- paste("Mean =", data_mean, "\nMedian =", data_median)
p <- ggplot() +
geom_histogram(aes(x = data),
color = "white",
binwidth = bin_width) +
geom_line(aes(x = data_rounded,
y = data_pareto),
color="red") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
color = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0, data_max + bin_width, by = bin_width)) +
scale_y_continuous(name = "Count",
breaks = seq(0, highest_count, by = 1),
sec.axis = sec_axis(~./highest_count, name = "Cumulative Percentage of Count")) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(x = "Value")
return(p)
}
brisk_walk_thld <- 80
running_thld <- 110
walking_times <- steps_src_mins_tall %>%
mutate(activity_day = yday(activity_minute)) %>%
group_by(id, activity_day) %>%
summarize(not_walking = sum(steps == 0) / 60,
moderate_walking = sum(steps > 0 & steps <= brisk_walk_thld) / 60,
brisk_walking = sum(steps > brisk_walk_thld & steps <= running_thld) / 60,
running = sum(steps > running_thld) / 60) %>%
group_by(id) %>%
summarize(not_walking = mean(not_walking),
moderate_walking = mean(moderate_walking),
brisk_walking = mean(brisk_walking),
running = mean(running)) %>%
arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_brisk_walking <- plot_histo_pareto(walking_times$brisk_walking, 0.25) +
labs(title = "Average Brisk Walking Hours per Week",
x = "Average Hours per Week")
print(plot_brisk_walking)
plot_running <- plot_histo_pareto(walking_times$running, 0.25) +
labs(title = "Average Running Hours per Week",
x = "Average Hours per Week")
print(plot_running)
plot_histo_pareto <- function (data, bin_width) {
# Cumulative data uses same bins as histogram
data <- sort(data)
rounding_factor <- 1 / bin_width
data_rounded <- round(data * rounding_factor) / rounding_factor
# Calculate highest count so axes can be adjusted
highest_count <- max(table(data_rounded))
data_pareto <- seq(1, length(data), by = 1) / length(data) * highest_count
# Calculate stats for overlay on histogram
data_max <- max(data)
data_mean <- round(mean(data), digits = 2)
data_median <- round(median(data), digits = 2)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(data_mean, data_median))
label_text <- paste("Mean =", data_mean, "\nMedian =", data_median)
p <- ggplot() +
geom_histogram(aes(x = data),
color = "white",
binwidth = bin_width) +
geom_line(aes(x = data_rounded,
y = data_pareto),
color="darkgreen") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
color = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0, data_max + bin_width, by = bin_width)) +
scale_y_continuous(name = "Count",
breaks = seq(0, highest_count, by = 1),
sec.axis = sec_axis(~./highest_count, name = "Cumulative Percentage of Count")) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(x = "Value")
return(p)
}
brisk_walk_thld <- 80
running_thld <- 110
walking_times <- steps_src_mins_tall %>%
mutate(activity_day = yday(activity_minute)) %>%
group_by(id, activity_day) %>%
summarize(not_walking = sum(steps == 0) / 60,
moderate_walking = sum(steps > 0 & steps <= brisk_walk_thld) / 60,
brisk_walking = sum(steps > brisk_walk_thld & steps <= running_thld) / 60,
running = sum(steps > running_thld) / 60) %>%
group_by(id) %>%
summarize(not_walking = mean(not_walking),
moderate_walking = mean(moderate_walking),
brisk_walking = mean(brisk_walking),
running = mean(running)) %>%
arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_brisk_walking <- plot_histo_pareto(walking_times$brisk_walking, 0.25) +
labs(title = "Average Brisk Walking Hours per Week",
x = "Average Hours per Week")
print(plot_brisk_walking)
plot_running <- plot_histo_pareto(walking_times$running, 0.25) +
labs(title = "Average Running Hours per Week",
x = "Average Hours per Week")
print(plot_running)
plot_histo_pareto <- function (data, bin_width) {
# Cumulative data uses same bins as histogram
data <- sort(data)
rounding_factor <- 1 / bin_width
data_rounded <- round(data * rounding_factor) / rounding_factor
# Calculate highest count so axes can be adjusted
highest_count <- max(table(data_rounded))
data_pareto <- seq(1, length(data), by = 1) / length(data) * highest_count
# Calculate stats for overlay on histogram
data_max <- max(data)
data_mean <- round(mean(data), digits = 2)
data_median <- round(median(data), digits = 2)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(data_mean, data_median))
label_text <- paste("Mean =", data_mean, "\nMedian =", data_median)
p <- ggplot() +
geom_histogram(aes(x = data),
color = "white",
binwidth = bin_width) +
geom_line(aes(x = data_rounded,
y = data_pareto),
color="forestgreen") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
color = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0, data_max + bin_width, by = bin_width)) +
scale_y_continuous(name = "Count",
breaks = seq(0, highest_count, by = 1),
sec.axis = sec_axis(~./highest_count, name = "Cumulative Percentage of Count")) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(x = "Value")
return(p)
}
brisk_walk_thld <- 80
running_thld <- 110
walking_times <- steps_src_mins_tall %>%
mutate(activity_day = yday(activity_minute)) %>%
group_by(id, activity_day) %>%
summarize(not_walking = sum(steps == 0) / 60,
moderate_walking = sum(steps > 0 & steps <= brisk_walk_thld) / 60,
brisk_walking = sum(steps > brisk_walk_thld & steps <= running_thld) / 60,
running = sum(steps > running_thld) / 60) %>%
group_by(id) %>%
summarize(not_walking = mean(not_walking),
moderate_walking = mean(moderate_walking),
brisk_walking = mean(brisk_walking),
running = mean(running)) %>%
arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_brisk_walking <- plot_histo_pareto(walking_times$brisk_walking, 0.25) +
labs(title = "Average Brisk Walking Hours per Week",
x = "Average Hours per Week")
print(plot_brisk_walking)
plot_running <- plot_histo_pareto(walking_times$running, 0.25) +
labs(title = "Average Running Hours per Week",
x = "Average Hours per Week")
print(plot_running)
plot_histo_pareto <- function (data, bin_width) {
# Cumulative data uses same bins as histogram
data <- sort(data)
rounding_factor <- 1 / bin_width
data_rounded <- round(data * rounding_factor) / rounding_factor
# Calculate highest count so axes can be adjusted
highest_count <- max(table(data_rounded))
data_pareto <- seq(1, length(data), by = 1) / length(data) * highest_count
# Calculate stats for overlay on histogram
data_max <- max(data)
data_mean <- round(mean(data), digits = 2)
data_median <- round(median(data), digits = 2)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(data_mean, data_median))
label_text <- paste("Mean =", data_mean, "\nMedian =", data_median)
p <- ggplot() +
geom_histogram(aes(x = data),
color = "white",
alpha = 0.75,
binwidth = bin_width) +
geom_line(aes(x = data_rounded,
y = data_pareto),
color="forestgreen") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
color = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0, data_max + bin_width, by = bin_width)) +
scale_y_continuous(name = "Count",
breaks = seq(0, highest_count, by = 1),
sec.axis = sec_axis(~./highest_count, name = "Cumulative Percentage of Count")) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(x = "Value")
return(p)
}
brisk_walk_thld <- 80
running_thld <- 110
walking_times <- steps_src_mins_tall %>%
mutate(activity_day = yday(activity_minute)) %>%
group_by(id, activity_day) %>%
summarize(not_walking = sum(steps == 0) / 60,
moderate_walking = sum(steps > 0 & steps <= brisk_walk_thld) / 60,
brisk_walking = sum(steps > brisk_walk_thld & steps <= running_thld) / 60,
running = sum(steps > running_thld) / 60) %>%
group_by(id) %>%
summarize(not_walking = mean(not_walking),
moderate_walking = mean(moderate_walking),
brisk_walking = mean(brisk_walking),
running = mean(running)) %>%
arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_brisk_walking <- plot_histo_pareto(walking_times$brisk_walking, 0.25) +
labs(title = "Average Brisk Walking Hours per Week",
x = "Average Hours per Week")
print(plot_brisk_walking)
plot_running <- plot_histo_pareto(walking_times$running, 0.25) +
labs(title = "Average Running Hours per Week",
x = "Average Hours per Week")
print(plot_running)
plot_histo_pareto <- function (data, bin_width) {
# Cumulative data uses same bins as histogram
data <- sort(data)
rounding_factor <- 1 / bin_width
data_rounded <- round(data * rounding_factor) / rounding_factor
# Calculate highest count so axes can be adjusted
highest_count <- max(table(data_rounded))
data_pareto <- seq(1, length(data), by = 1) / length(data) * highest_count
# Calculate stats for overlay on histogram
data_max <- max(data)
data_mean <- round(mean(data), digits = 2)
data_median <- round(median(data), digits = 2)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(data_mean, data_median))
label_text <- paste("Mean =", data_mean, "\nMedian =", data_median)
p <- ggplot() +
geom_histogram(aes(x = data),
color = "white",
binwidth = bin_width) +
geom_line(aes(x = data_rounded,
y = data_pareto),
color="forestgreen") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
color = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0, data_max + bin_width, by = bin_width)) +
scale_y_continuous(name = "Count",
breaks = seq(0, highest_count, by = 1),
sec.axis = sec_axis(~./highest_count, name = "Cumulative Percentage of Count")) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(x = "Value")
return(p)
}
brisk_walk_thld <- 80
running_thld <- 110
walking_times <- steps_src_mins_tall %>%
mutate(activity_day = yday(activity_minute)) %>%
group_by(id, activity_day) %>%
summarize(not_walking = sum(steps == 0) / 60,
moderate_walking = sum(steps > 0 & steps <= brisk_walk_thld) / 60,
brisk_walking = sum(steps > brisk_walk_thld & steps <= running_thld) / 60,
running = sum(steps > running_thld) / 60) %>%
group_by(id) %>%
summarize(not_walking = mean(not_walking),
moderate_walking = mean(moderate_walking),
brisk_walking = mean(brisk_walking),
running = mean(running)) %>%
arrange(running)
speed_order = c("not_walking", "moderate_walking", "brisk_walking", "running")
walking_times_long <- walking_times %>%
tidyr::gather(key = "speed", value = "mean_hours", -id) %>%
mutate(speed = factor(speed, levels = speed_order))
walking_times_long$id <- factor(
walking_times_long$id,
levels = walking_times$id
)
ggplot(walking_times_long %>% filter(speed != "not_walking"),
aes(x = id, y = mean_hours, fill = speed)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_y_continuous(breaks = seq(0,33,by=1)) +
labs(title = "Average Daily Running Speeds by User ID",
x = "User ID",
y = "Average Daily Hours")
plot_mod_walking <- plot_histo_pareto(walking_times$moderate_walking, 0.25) +
labs(title = "Average Moderate Walking Hours per Week",
x = "Average Hours per Week")
print(plot_mod_walking)
plot_brisk_walking <- plot_histo_pareto(walking_times$brisk_walking, 0.25) +
labs(title = "Average Brisk Walking Hours per Week",
x = "Average Hours per Week")
print(plot_brisk_walking)
plot_running <- plot_histo_pareto(walking_times$running, 0.25) +
labs(title = "Average Running Hours per Week",
x = "Average Hours per Week")
print(plot_running)
# Naive method: Graph all the steps over time
ggplot(steps_sum_days_tall) +
geom_line(aes(x = activity_day, y = steps_total)) +
facet_wrap(vars(id))
# Cynical method: generate all the correlations between steps and time
step_count_coefficients <- steps_sum_days_tall %>%
mutate(day_of_year = yday(activity_day)) %>%
group_by(id) %>%
summarize(correlation = cor(day_of_year, steps_total))
plot_bin_width <- 0.1
ggplot(step_count_coefficients, aes(x = correlation)) +
geom_histogram(binwidth = plot_bin_width, color = "white") +
scale_x_continuous(breaks = seq(-1.0,1.0,by=plot_bin_width)) +
scale_y_continuous(breaks = seq(0,13,by=1)) +
labs(title = "Correlations between Step Count and Time",
caption = "Positive values imply Step Count generally increased over time.",
x = "Coefficient of Correlation",
y = "Users")
average_daily_steps <- steps_sum_days_tall %>%
group_by(id) %>%
summarize(average_steps = mean(steps_total))
mean_steps <- round(mean(average_daily_steps$average_steps),digits=0)
median_steps <- round(median(average_daily_steps$average_steps),digits=0)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(mean_steps, median_steps))
label_text <- paste("Mean =", mean_steps, "steps\nMedian =", median_steps, "steps")
ggplot(average_daily_steps) +
geom_histogram(aes(x=average_steps),
binwidth = 1000,
col = "white") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
col = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0,16000,by=1000)) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps",
y = "Users")
ggplot() +
geom_bar(data = hist_data,
aes(x = mid, y = counts),
stat = "identity",
color = "white",
fill = "lightblue") +
geom_density(data = density_data,
aes(x = x, y = y),
color = "red") +
scale_y_continuous(name = "Counts",
sec.axis = sec_axis(~ . / sum(hist_data$counts),
name = "Density")) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps",
y = "Users")
print(plot_steps)
average_daily_steps <- steps_sum_days_tall %>%
group_by(id) %>%
summarize(average_steps = mean(steps_total))
mean_steps <- round(mean(average_daily_steps$average_steps),digits=0)
median_steps <- round(median(average_daily_steps$average_steps),digits=0)
sum_stats <- data.frame(Statistics = c("Mean", "Median"),
value = c(mean_steps, median_steps))
label_text <- paste("Mean =", mean_steps, "steps\nMedian =", median_steps, "steps")
ggplot(average_daily_steps) +
geom_histogram(aes(x=average_steps),
binwidth = 1000,
col = "white") +
geom_vline(data = sum_stats,
aes(xintercept = value,
linetype = Statistics,
col = Statistics),
size = 1) +
scale_x_continuous(breaks = seq(0,16000,by=1000)) +
annotate("text", x = Inf, y = Inf, label = label_text,
hjust = 1, vjust = 1, size = 4) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps",
y = "Users")
plot_steps <- plot_histo_pareto(average_daily_steps$average_steps, 1000) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps")
print(plot_steps)
plot_steps <- plot_histo_pareto(average_daily_steps$average_steps, 2000) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps")
print(plot_steps)
average_daily_steps <- steps_sum_days_tall %>%
group_by(id) %>%
summarize(average_steps = mean(steps_total))
plot_steps <- plot_histo_pareto(average_daily_steps$average_steps, 2000) +
labs(title = "Average Daily Steps by User",
x = "Average Daily Steps")
print(plot_steps)
